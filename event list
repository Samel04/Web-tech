<?php
include("../config/db.php");
if ($_SESSION['role'] != 'admin') die("Access denied");

$sql = "SELECT e.*, u.full_name 
        FROM events e 
        JOIN users u ON e.organizer_id = u.user_id
        WHERE status='pending'";
$result = $conn->query($sql);
?>

<h2>Pending Event Approval</h2>

<table border="1">
<tr>
    <th>Title</th>
    <th>Organizer</th>
    <th>Date</th>
    <th>Action</th>
</tr>

<?php while($row = $result->fetch_assoc()) { ?>
<tr>
    <td><?= $row['title'] ?></td>
    <td><?= $row['full_name'] ?></td>
    <td><?= $row['event_date'] ?></td>
    <td>
        <a href="event_approve.php?id=<?= $row['event_id'] ?>&action=approved">Approve</a> |
        <a href="event_approve.php?id=<?= $row['event_id'] ?>&action=rejected">Reject</a>
    </td>
</tr>
<?php } ?>
</table>
